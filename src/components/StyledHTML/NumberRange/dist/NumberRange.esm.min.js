import e from"vue-styled-components";import"@IntusFacultas/design-system";import{NInput as n}from"@IntusFacultas/input";import{NLabel as r}from"@IntusFacultas/typography";function t(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function a(){var e=t(["\n  display: flex;\n  flex-direction: row;\n"]);return a=function(){return e},e}function l(){var e=t(["\n  margin-left: 2px;\n  margin-right: 2px;\n"]);return l=function(){return e},e}function i(){var e=t(["\n  display: flex;\n  flex-direction: column;\n"]);return i=function(){return e},e}var s=e.div(i()),u=e.div(l()),o={components:{NumberContainer:s,InputContainer:e.div(a()),InputGroupContainer:u,NLabel:r,NInput:n},data:function(){return{lowerValue:0,upperValue:0,internalSteps:[]}},props:{value:{type:Object,default:function(){return{lowValue:0,highValue:0}}},labelFlavor:{type:String,default:""},name:{type:String,required:!0},label:{type:String,required:!0},max:{type:Number,required:!0},min:{type:Number,required:!0},steps:{type:Array,default:function(){return[1]}}},watch:{steps:function(){this.internalSteps=this.steps.slice().sort((function(e,n){return e>=n}))}},mounted:function(){this.lowerValue=this.min,this.upperValue=this.max;var e=this;if(e.$watch("value",(function(){e.lowerValue!=e.value.lowerValue&&(e.lowerValue=e.value.lowerValue,e.validateValue()),e.upperValue!=e.value.upperValue&&(e.upperValue=e.value.upperValue,e.validateValue())}),{deep:!0}),0==this.steps.length)throw"Steps must have at least one value";if(this.steps.length>1){if(this.steps[0]!=this.min)throw"Discrete steps must have a first value equal to the minimum";if(this.steps[this.steps.length-1]!=this.max)throw"Discrete steps must have a last value equal to the maximum"}this.internalSteps=this.steps.slice().sort((function(e,n){return e>=n})),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t=arguments[1],a=0;a<r;){var l=n[a];if(e.call(t,l,a,n))return a;a++}return-1},configurable:!0,writable:!0})},beforeDestroy:function(){},methods:{increment:function(e,n){var r=this;if(e.preventDefault(),this[n]!=this.max){if(this.internalSteps.length>1){var t=this.internalSteps.findIndex((function(e){return e==r[n]}))+1;t>=this.internalSteps.length&&(t=this.internalSteps.length-1),this[n]=parseFloat(this.internalSteps[t])}else this[n]+=parseFloat(this.internalSteps[0]);this.validateValue()}},decrement:function(e,n){var r=this;if(e.preventDefault(),this[n]!=this.min){if(this.internalSteps.length>1){var t=this.internalSteps.findIndex((function(e){return e==r[n]}))-1;t<=0&&(t=0),this[n]=parseFloat(this.internalSteps[t])}else this[n]-=parseFloat(this.internalSteps[0]);this.validateValue()}},roundValues:function(e){var n=this.internalSteps.slice();n.push(parseFloat(e)),n.sort((function(e,n){return e>=n}));var r=n.findIndex((function(n){return n==parseFloat(e)})),t=r-1,a=r+1;return t<0&&(t=0),a>=n.length&&(a=n.length-1),n=n.slice(t,a+1)},roundToNearestDiscreteStep:function(e,n){var r=Math.abs(e[0]-n);return Math.abs(e[e.length-1]-n)<r?e[e.length-1]:e[0]},roundToNearestBasicStep:function(e,n){for(var r,t=0,a=0,l=e;Math.abs(l-n)%this.internalSteps[0]!=0;)t++,l--;for(r=l,l=e;Math.abs(l-n)%this.internalSteps[0]!=0;)a++,l++;return t<=a?r:l},validateValue:function(){if(1!=this.internalSteps.length){if(-1==this.internalSteps.indexOf(this.lowerValue)){var e=this.roundValues(this.lowerValue);this.lowerValue=parseFloat(this.roundToNearestDiscreteStep(e,this.lowerValue))}if(-1==this.internalSteps.indexOf(this.upperValue)){var n=this.roundValues(this.upperValue);this.upperValue=parseFloat(this.roundToNearestDiscreteStep(n,this.upperValue))}}else Math.abs(this.lowerValue-this.min)%this.internalSteps[0]!=0&&(this.lowerValue=this.roundToNearestBasicStep(this.lowerValue,this.min)),Math.abs(this.upperValue-this.max)%this.internalSteps[0]!=0&&(this.upperValue=this.roundToNearestBasicStep(this.upperValue,this.max));this.upperValue>this.max&&(this.upperValue=this.max),this.lowerValue<this.min&&(this.lowerValue=this.min),this.lowerValue>this.upperValue&&(this.lowerValue=parseFloat(this.upperValue)),this.lowerValue=parseFloat(this.lowerValue),this.upperValue=parseFloat(this.upperValue),this.$emit("change",{lowerValue:this.lowerValue,upperValue:this.upperValue})}}};const p="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());let h;const d={};const c=o;var m=function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("number-container",[r("input-container",[r("input-group-container",{staticClass:"number-range-min-input-container"},[r("n-label",{attrs:{flavor:e.labelFlavor,for:e.name+"LowerValue"}},[e._v(e._s(e.label)+" Lower")]),e._v(" "),r("n-input",{ref:"minInput",attrs:{type:"number",name:e.name+"LowerValue",id:e.name+"LowerValue",min:e.min,max:e.upperValue},on:{keydown:[function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"up",38,n.key,["Up","ArrowUp"])?null:e.increment(n,"lowerValue")},function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"down",40,n.key,["Down","ArrowDown"])?null:e.decrement(n,"lowerValue")}],change:e.validateValue},model:{value:e.lowerValue,callback:function(n){e.lowerValue=n},expression:"lowerValue"}})],1),e._v(" "),r("input-group-container",[r("n-label",{staticClass:"number-range-max-label",attrs:{flavor:e.labelFlavor,for:e.name+"UpperValue"}},[e._v(e._s(e.label)+" Upper")]),e._v(" "),r("n-input",{ref:"maxInput",attrs:{type:"number",name:e.name+"UpperValue",id:e.name+"UpperValue",min:e.lowerValue,max:e.max},on:{keydown:[function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"up",38,n.key,["Up","ArrowUp"])?null:e.increment(n,"upperValue")},function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"down",40,n.key,["Down","ArrowDown"])?null:e.decrement(n,"upperValue")}],change:e.validateValue},model:{value:e.upperValue,callback:function(n){e.upperValue=n},expression:"upperValue"}})],1)],1)],1)};m._withStripped=!0;const f=function(e,n,r,t,a,l,i,s,u,o){"boolean"!=typeof i&&(u=s,s=i,i=!1);const p="function"==typeof r?r.options:r;let h;if(e&&e.render&&(p.render=e.render,p.staticRenderFns=e.staticRenderFns,p._compiled=!0,a&&(p.functional=!0)),t&&(p._scopeId=t),l?(h=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,u(e)),e&&e._registeredComponents&&e._registeredComponents.add(l)},p._ssrRegister=h):n&&(h=i?function(e){n.call(this,o(e,this.$root.$options.shadowRoot))}:function(e){n.call(this,s(e))}),h)if(p.functional){const e=p.render;p.render=function(n,r){return h.call(r),e(n,r)}}else{const e=p.beforeCreate;p.beforeCreate=e?[].concat(e,h):[h]}return r}({render:m,staticRenderFns:[]},(function(e){e&&e("data-v-5e6c59a1_0",{source:"\n.number-range-max-label {\r\n  float: right;\r\n  text-align: end;\n}\r\n",map:{version:3,sources:["C:\\Users\\pedro\\Documents\\Personal Projects\\GitHub\\storybook\\storybook\\src\\components\\StyledHTML\\NumberRange\\src\\NumberRange.vue"],names:[],mappings:";AAgVA;EACA,YAAA;EACA,eAAA;AACA",file:"NumberRange.vue",sourcesContent:['<template>\r\n  <number-container>\r\n    <input-container>\r\n      <input-group-container class="number-range-min-input-container">\r\n        <n-label :flavor="labelFlavor" :for="name + \'LowerValue\'"\r\n          >{{ label }} Lower</n-label\r\n        >\r\n        <n-input\r\n          @keydown.up="increment($event, \'lowerValue\')"\r\n          @keydown.down="decrement($event, \'lowerValue\')"\r\n          type="number"\r\n          v-model="lowerValue"\r\n          @change="validateValue"\r\n          :name="name + \'LowerValue\'"\r\n          :id="name + \'LowerValue\'"\r\n          ref="minInput"\r\n          :min="min"\r\n          :max="upperValue"\r\n        ></n-input>\r\n      </input-group-container>\r\n      <input-group-container>\r\n        <n-label\r\n          :flavor="labelFlavor"\r\n          class="number-range-max-label"\r\n          :for="name + \'UpperValue\'"\r\n          >{{ label }} Upper</n-label\r\n        >\r\n        <n-input\r\n          @keydown.up="increment($event, \'upperValue\')"\r\n          @keydown.down="decrement($event, \'upperValue\')"\r\n          type="number"\r\n          v-model="upperValue"\r\n          @change="validateValue"\r\n          :name="name + \'UpperValue\'"\r\n          :id="name + \'UpperValue\'"\r\n          ref="maxInput"\r\n          :min="lowerValue"\r\n          :max="max"\r\n        ></n-input>\r\n      </input-group-container>\r\n    </input-container>\r\n  </number-container>\r\n</template>\r\n\r\n<script>\r\nimport styled from "vue-styled-components";\r\nimport Theme from "@IntusFacultas/design-system";\r\nimport { NInput } from "@IntusFacultas/input";\r\nimport { NLabel } from "@IntusFacultas/typography";\r\nconst props = {\r\n  flavor: String,\r\n  defaultTheme: {\r\n    type: Object,\r\n    default: function() {\r\n      return Theme;\r\n    }\r\n  }\r\n};\r\nconst NumberContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\nconst InputGroupContainer = styled.div`\r\n  margin-left: 2px;\r\n  margin-right: 2px;\r\n`;\r\nconst InputContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: row;\r\n`;\r\n\r\nexport const NumberRange = {\r\n  components: {\r\n    NumberContainer,\r\n    InputContainer,\r\n    InputGroupContainer,\r\n    NLabel,\r\n    NInput\r\n  },\r\n  data() {\r\n    return {\r\n      lowerValue: 0,\r\n      upperValue: 0,\r\n      internalSteps: []\r\n    };\r\n  },\r\n  props: {\r\n    value: {\r\n      type: Object,\r\n      default() {\r\n        return {\r\n          lowValue: 0,\r\n          highValue: 0\r\n        };\r\n      }\r\n    },\r\n    labelFlavor: {\r\n      type: String,\r\n      default: ""\r\n    },\r\n    name: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    label: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    max: {\r\n      type: Number,\r\n      required: true\r\n    },\r\n    min: {\r\n      type: Number,\r\n      required: true\r\n    },\r\n    steps: {\r\n      type: Array,\r\n      default() {\r\n        return [1];\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    steps() {\r\n      this.internalSteps = this.steps.slice().sort((x, y) => x >= y);\r\n    }\r\n  },\r\n  mounted() {\r\n    this.lowerValue = this.min;\r\n    this.upperValue = this.max;\r\n    let self = this;\r\n    self.$watch(\r\n      "value",\r\n      function() {\r\n        if (self.lowerValue != self.value.lowerValue) {\r\n          self.lowerValue = self.value.lowerValue;\r\n          self.validateValue();\r\n        }\r\n        if (self.upperValue != self.value.upperValue) {\r\n          self.upperValue = self.value.upperValue;\r\n          self.validateValue();\r\n        }\r\n      },\r\n      { deep: true }\r\n    );\r\n    if (this.steps.length == 0) {\r\n      throw "Steps must have at least one value";\r\n    }\r\n    if (this.steps.length > 1) {\r\n      if (this.steps[0] != this.min) {\r\n        throw "Discrete steps must have a first value equal to the minimum";\r\n      }\r\n      if (this.steps[this.steps.length - 1] != this.max) {\r\n        throw "Discrete steps must have a last value equal to the maximum";\r\n      }\r\n    }\r\n    this.internalSteps = this.steps.slice().sort((x, y) => x >= y);\r\n    if (!Array.prototype.findIndex) {\r\n      Object.defineProperty(Array.prototype, "findIndex", {\r\n        value: function(predicate) {\r\n          // 1. Let O be ? ToObject(this value).\r\n          if (this == null) {\r\n            throw new TypeError(\'"this" is null or not defined\');\r\n          }\r\n\r\n          var o = Object(this);\r\n\r\n          // 2. Let len be ? ToLength(? Get(O, "length")).\r\n          var len = o.length >>> 0;\r\n\r\n          // 3. If IsCallable(predicate) is false, throw a TypeError exception.\r\n          if (typeof predicate !== "function") {\r\n            throw new TypeError("predicate must be a function");\r\n          }\r\n\r\n          // 4. If thisArg was supplied, let T be thisArg; else let T be undefined.\r\n          var thisArg = arguments[1];\r\n\r\n          // 5. Let k be 0.\r\n          var k = 0;\r\n\r\n          // 6. Repeat, while k < len\r\n          while (k < len) {\r\n            // a. Let Pk be ! ToString(k).\r\n            // b. Let kValue be ? Get(O, Pk).\r\n            // c. Let testResult be ToBoolean(? Call(predicate, T, « kValue, k, O »)).\r\n            // d. If testResult is true, return k.\r\n            var kValue = o[k];\r\n            if (predicate.call(thisArg, kValue, k, o)) {\r\n              return k;\r\n            }\r\n            // e. Increase k by 1.\r\n            k++;\r\n          }\r\n\r\n          // 7. Return -1.\r\n          return -1;\r\n        },\r\n        configurable: true,\r\n        writable: true\r\n      });\r\n    }\r\n  },\r\n  beforeDestroy() {},\r\n  methods: {\r\n    increment(event, value) {\r\n      event.preventDefault();\r\n      if (this[value] == this.max) {\r\n        return;\r\n      }\r\n      if (this.internalSteps.length > 1) {\r\n        let nextIndex = this.internalSteps.findIndex(x => x == this[value]) + 1;\r\n        if (nextIndex >= this.internalSteps.length) {\r\n          nextIndex = this.internalSteps.length - 1;\r\n        }\r\n        this[value] = parseFloat(this.internalSteps[nextIndex]);\r\n      } else {\r\n        this[value] += parseFloat(this.internalSteps[0]);\r\n      }\r\n      this.validateValue();\r\n    },\r\n    decrement(event, value) {\r\n      event.preventDefault();\r\n      if (this[value] == this.min) {\r\n        return;\r\n      }\r\n      if (this.internalSteps.length > 1) {\r\n        let nextIndex = this.internalSteps.findIndex(x => x == this[value]) - 1;\r\n        if (nextIndex <= 0) {\r\n          nextIndex = 0;\r\n        }\r\n        this[value] = parseFloat(this.internalSteps[nextIndex]);\r\n      } else {\r\n        this[value] -= parseFloat(this.internalSteps[0]);\r\n      }\r\n      this.validateValue();\r\n    },\r\n    roundValues(value) {\r\n      let copy = this.internalSteps.slice();\r\n      copy.push(parseFloat(value));\r\n      copy.sort((x, y) => x >= y);\r\n      let index = copy.findIndex(x => x == parseFloat(value));\r\n      let lowerBound = index - 1;\r\n      let upperBound = index + 1;\r\n      if (lowerBound < 0) {\r\n        lowerBound = 0;\r\n      }\r\n      if (upperBound >= copy.length) {\r\n        upperBound = copy.length - 1;\r\n      }\r\n      copy = copy.slice(lowerBound, upperBound + 1);\r\n      return copy;\r\n    },\r\n    roundToNearestDiscreteStep(values, value) {\r\n      let lowerDelta = Math.abs(values[0] - value);\r\n      let upperDelta = Math.abs(values[values.length - 1] - value);\r\n      if (upperDelta < lowerDelta) {\r\n        // round up\r\n        return values[values.length - 1];\r\n      } else {\r\n        return values[0];\r\n      }\r\n    },\r\n    roundToNearestBasicStep(value, base) {\r\n      let distanceToBottom = 0;\r\n      let distanceToTop = 0;\r\n      let tracker = value;\r\n      let bottom = 0;\r\n      let top = 0;\r\n      while (Math.abs(tracker - base) % this.internalSteps[0] != 0) {\r\n        distanceToBottom++;\r\n        tracker--;\r\n      }\r\n      bottom = tracker;\r\n      tracker = value;\r\n      while (Math.abs(tracker - base) % this.internalSteps[0] != 0) {\r\n        distanceToTop++;\r\n        tracker++;\r\n      }\r\n      top = tracker;\r\n      if (distanceToBottom <= distanceToTop) {\r\n        return bottom;\r\n      }\r\n      return top;\r\n    },\r\n    validateValue() {\r\n      if (this.internalSteps.length != 1) {\r\n        if (this.internalSteps.indexOf(this.lowerValue) == -1) {\r\n          let copy = this.roundValues(this.lowerValue);\r\n          this.lowerValue = parseFloat(\r\n            this.roundToNearestDiscreteStep(copy, this.lowerValue)\r\n          );\r\n        }\r\n        if (this.internalSteps.indexOf(this.upperValue) == -1) {\r\n          let copy = this.roundValues(this.upperValue);\r\n          this.upperValue = parseFloat(\r\n            this.roundToNearestDiscreteStep(copy, this.upperValue)\r\n          );\r\n        }\r\n      } else {\r\n        if (Math.abs(this.lowerValue - this.min) % this.internalSteps[0] != 0) {\r\n          this.lowerValue = this.roundToNearestBasicStep(\r\n            this.lowerValue,\r\n            this.min\r\n          );\r\n        }\r\n        if (Math.abs(this.upperValue - this.max) % this.internalSteps[0] != 0) {\r\n          this.upperValue = this.roundToNearestBasicStep(\r\n            this.upperValue,\r\n            this.max\r\n          );\r\n        }\r\n      }\r\n      if (this.upperValue > this.max) {\r\n        this.upperValue = this.max;\r\n      }\r\n      if (this.lowerValue < this.min) {\r\n        this.lowerValue = this.min;\r\n      }\r\n      if (this.lowerValue > this.upperValue) {\r\n        this.lowerValue = parseFloat(this.upperValue);\r\n      }\r\n      this.lowerValue = parseFloat(this.lowerValue);\r\n      this.upperValue = parseFloat(this.upperValue);\r\n      this.$emit("change", {\r\n        lowerValue: this.lowerValue,\r\n        upperValue: this.upperValue\r\n      });\r\n    }\r\n  }\r\n};\r\nexport default NumberRange;\r\n<\/script>\r\n\r\n<style>\r\n.number-range-max-label {\r\n  float: right;\r\n  text-align: end;\r\n}\r\n</style>\r\n']},media:void 0})}),c,void 0,!1,void 0,!1,(function(e){return(e,n)=>function(e,n){const r=p?n.media||"default":e,t=d[r]||(d[r]={ids:new Set,styles:[]});if(!t.ids.has(e)){t.ids.add(e);let r=n.source;if(n.map&&(r+="\n/*# sourceURL="+n.map.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n.map))))+" */"),t.element||(t.element=document.createElement("style"),t.element.type="text/css",n.media&&t.element.setAttribute("media",n.media),void 0===h&&(h=document.head||document.getElementsByTagName("head")[0]),h.appendChild(t.element)),"styleSheet"in t.element)t.styles.push(r),t.element.styleSheet.cssText=t.styles.filter(Boolean).join("\n");else{const e=t.ids.size-1,n=document.createTextNode(r),a=t.element.childNodes;a[e]&&t.element.removeChild(a[e]),a.length?t.element.insertBefore(n,a[e]):t.element.appendChild(n)}}}(e,n)}),void 0,void 0);var v=function(e){v.installed||(v.installed=!0,e.component("NumberRange",f))},V={install:v},w=null;"undefined"!=typeof window?w=window.Vue:"undefined"!=typeof global&&(w=global.Vue),w&&w.use(V),f.install=v;export default f;
